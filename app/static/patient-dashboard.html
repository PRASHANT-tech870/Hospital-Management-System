<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Patient Dashboard - HMS</title>
  <link rel="stylesheet" href="/static/style.css">
  <link rel="stylesheet" href="/static/shared-dashboard.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>Patient Dashboard</h1>
      <p class="subtitle">Welcome, <span id="patient-name">Patient</span></p>
    </header>

    <div id="error-container" style="display: none;" class="error-message">
      <!-- Error messages will be shown here -->
    </div>

    <div class="dashboard-container">
      <div class="dashboard-card">
        <h3>My Appointments</h3>
        <div id="appointments-list">
          <!-- Appointments will be loaded here -->
        </div>
      </div>

      <div class="dashboard-card">
        <h3>Medical History</h3>
        <div id="medical-history-list"></div>
        
        <!-- Doctor Notes Section -->
        <div id="doctor-notes-section">
            <h4>Doctor Notes</h4>
            <div id="doctor-notes-list"></div>
        </div>
        
        <button class="login-btn" onclick="showAddHistoryForm()">Add Medical History</button>
        
        <!-- Add History Form -->
        <div id="add-history-form" style="display: none;">
            <form id="history-form" class="form-group">
                <input type="text" id="condition" placeholder="Condition" required>
                <input type="date" id="diagnosis-date" required>
                <textarea id="treatment" placeholder="Treatment Details" required></textarea>
                <label>
                    <input type="checkbox" id="is-chronic">
                    Chronic Condition
                </label>
                <textarea id="history-notes" placeholder="Additional Notes"></textarea>
                <button type="submit" class="login-btn">Save History</button>
            </form>
        </div>
      </div>

      <div class="dashboard-card">
        <h3>Billing Information</h3>
        <div id="billing-info">
            <div class="billing-summary">
                <h4>Invoices</h4>
                <div id="invoices-list"></div>
            </div>
            
            <!-- Payment Modal -->
            <div id="payment-modal" class="modal" style="display: none;">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h4>Payment Details</h4>
                    <div id="payment-details"></div>
                    <form id="payment-form" class="form-group">
                        <input type="hidden" id="invoice-id">
                        <div class="form-group">
                            <label for="card-number">Card Number</label>
                            <input type="text" id="card-number" required pattern="[0-9]{16}" placeholder="1234 5678 9012 3456">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="expiry">Expiry (MM/YY)</label>
                                <input type="text" id="expiry" required pattern="[0-9]{2}/[0-9]{2}" placeholder="MM/YY">
                            </div>
                            <div class="form-group">
                                <label for="cvv">CVV</label>
                                <input type="text" id="cvv" required pattern="[0-9]{3}" placeholder="123">
                            </div>
                        </div>
                        <button type="submit" class="login-btn">Pay Now</button>
                    </form>
                </div>
            </div>
        </div>
      </div>

      <div class="dashboard-card">
        <h3>Book Appointment</h3>
        <form id="appointment-form">
          <div class="form-group">
            <label for="specialization">Select Specialization</label>
            <select id="specialization" required>
              <option value="">-- Select Specialization --</option>
              <!-- Will be populated dynamically -->
            </select>
          </div>

          <div class="form-group">
            <label for="doctor">Select Doctor</label>
            <select id="doctor" required disabled>
              <option value="">-- Select Doctor --</option>
              <!-- Will be populated after specialization is selected -->
            </select>
          </div>

          <div class="form-group">
            <label for="appointment-date">Select Date</label>
            <input type="date" id="appointment-date" required disabled>
          </div>

          <div class="form-group">
            <label for="time-slot">Select Time</label>
            <select id="time-slot" required disabled>
              <option value="">-- Select Time Slot --</option>
              <!-- Will be populated after date is selected -->
            </select>
          </div>

          <div class="form-group">
            <label for="purpose">Purpose of Visit</label>
            <textarea id="purpose" required></textarea>
          </div>

          <button type="submit" class="login-btn">Book Appointment</button>
        </form>
      </div>
    </div>

    <footer>
      <button class="logout-btn" onclick="logout()">Logout</button>
      <p>Â© 2024 Hospital Management System</p>
    </footer>
  </div>

  <script src="/static/dashboard.js"></script>
  <script src="/static/appointment.js"></script>
  <script src="/static/medical-history.js"></script>
  <script src="/static/billing.js"></script>
</body>
</html>
